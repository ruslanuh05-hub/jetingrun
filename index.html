<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>JET</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: linear-gradient(180deg, #0a0a0a 0%, #0d0d0d 50%, #0a0a0a 100%);
        }
        
        /* Экран загрузки */
        .loading-screen {
            position: fixed;
            inset: 0;
            background: linear-gradient(180deg, #0a0a0a 0%, #0d0d0d 50%, #0a0a0a 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 999999;
        }
        
        .loading-logo {
            width: 120px;
            height: 120px;
            min-width: 120px;
            min-height: 120px;
            object-fit: contain;
            margin-bottom: 32px;
            animation: logoPulse 2s ease-in-out infinite;
            display: block !important;
            opacity: 1 !important;
            visibility: visible !important;
            background: transparent;
        }
        
        @keyframes logoPulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.9;
            }
        }
        
        .loading-text {
            color: #ffffff;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 40px;
            text-align: center;
            letter-spacing: 0.5px;
        }
        
        .loading-progress-container {
            width: 280px;
            max-width: 80%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
            position: relative;
        }
        
        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00d4ff 0%, #00a4ff 50%, #0078ff 100%);
            border-radius: 2px;
            width: 0%;
            transition: width 0.3s ease;
            animation: progressShimmer 1.5s ease-in-out infinite;
        }
        
        @keyframes progressShimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }
        
        .loading-link {
            display: none;
        }
    </style>
    <script>
        // Telegram внедряет объект только в ПЕРВЫЙ документ. После редиректа на html/index.html
        // новый документ не получает window.Telegram. Сохраняем initData перед переходом.
        (function() {
            function go() {
                var tg = window.Telegram && window.Telegram.WebApp;
                if (tg && tg.initData) {
                    try {
                        sessionStorage.setItem('jet_tg_init_data', tg.initData || '');
                        if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                            sessionStorage.setItem('jet_tg_user', JSON.stringify(tg.initDataUnsafe.user));
                        }
                    } catch (e) {}
                }
                
                // Завершаем прогресс до 100% перед переходом
                var progressBar = document.getElementById('loadingProgressBar');
                if (progressBar) {
                    progressBar.style.width = '100%';
                }
                
                // Переход после небольшой задержки
                setTimeout(function() {
                    window.location.href = 'html/index.html';
                }, 300);
            }
            
            // Показываем загрузочный экран с анимацией прогресса
            function startLoading() {
                var progressBar = document.getElementById('loadingProgressBar');
                if (progressBar) {
                    var progress = 0;
                    var interval = setInterval(function() {
                        progress += Math.random() * 15 + 5; // Случайный шаг от 5 до 20%
                        if (progress > 90) progress = 90; // Останавливаемся на 90%
                        progressBar.style.width = progress + '%';
                    }, 200);
                    
                    // Сохраняем интервал для остановки
                    window.loadingProgressInterval = interval;
                }
            }
            
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    startLoading();
                    setTimeout(go, 1500); // Переход через 1.5 секунды
                });
            } else {
                startLoading();
                setTimeout(go, 1500);
            }
        })();
    </script>
</head>
<body>
    <!-- Экран загрузки -->
    <div class="loading-screen">
        <img src="assets/logo_load.jpg" alt="JET" class="loading-logo" id="loadingLogo"
             style="display: block; opacity: 1; visibility: visible;"
             onload="console.log('Logo loaded successfully:', this.src); this.style.display='block'; this.style.opacity='1';"
             onerror="console.error('Failed to load logo_load.jpg, trying png'); var img = this; img.onerror=null; img.src='assets/logo_load.png'; img.onerror=function(){console.error('Failed to load logo_load.png too'); var fallback = document.createElement('div'); fallback.className='loading-logo'; fallback.style.width='120px'; fallback.style.height='120px'; fallback.style.borderRadius='50%'; fallback.style.background='linear-gradient(135deg, #00d4ff 0%, #00a4ff 50%, #0078ff 100%)'; fallback.style.display='flex'; fallback.style.alignItems='center'; fallback.style.justifyContent='center'; fallback.style.color='#000'; fallback.style.fontSize='3rem'; fallback.style.fontWeight='bold'; fallback.textContent='JET'; img.parentNode.replaceChild(fallback, img);}">
        <div class="loading-text">Jet Store</div>
        <div class="loading-progress-container">
            <div class="loading-progress-bar" id="loadingProgressBar"></div>
        </div>
    </div>
    
    <p class="loading-link">Переход на <a href="html/index.html">главную</a>...</p>
</body>
</html>
